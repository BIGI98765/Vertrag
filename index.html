<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kaufvertrag Generator</title>
  <link rel="icon" href="icon.png" type="image/png">
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: auto;
      padding: 20px;
      background: #f9f9f9;
    }
    input, button {
      padding: 8px;
      margin: 5px 0;
      width: 100%;
    }
    h1 {
      text-align: center;
    }
    .logo {
      width: 100px;
      display: block;
      margin: 0 auto 20px;
    }
  </style>
</head>
<body>
  <img src="icon.png" class="logo" />
  <h1>Kaufvertrag für gebrauchten PC</h1>

  <label>Vor- und Nachname (Verkäufer):</label>
  <input id="verkaeufer" type="text"/>

  <label>Vor- und Nachname (Käufer):</label>
  <input id="kaeufer" type="text"/>

  <label>Beschreibung des PCs (optional):</label>
  <input id="beschreibung" type="text" placeholder="z. B. Gaming-PC mit RTX 4060, 16GB RAM"/>

  <label>Verkaufspreis (€):</label>
  <input id="preis" type="number"/>

  <label>Ort:</label>
  <input id="ort" type="text" placeholder="z. B. Oldenburg"/>

  <label>Datum:</label>
  <input id="datum" type="date"/>

  <button onclick="generatePDF()">PDF erstellen</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const verkaeufer = document.getElementById("verkaeufer").value.trim();
      const kaeufer = document.getElementById("kaeufer").value.trim();
      const beschreibung = document.getElementById("beschreibung").value.trim();
      const preis = document.getElementById("preis").value.trim();
      const ort = document.getElementById("ort").value.trim();
      const datumInput = document.getElementById("datum").value;

      const datum = datumInput ? new Date(datumInput).toLocaleDateString("de-DE") : "________";

      const logo = new Image();
      logo.src = "icon.png";

      logo.onload = function () {
        doc.addImage(logo, "PNG", 80, 10, 50, 50); // Logo oben
        let y = 70;

        doc.setFont("helvetica", "bold");
        doc.setFontSize(16);
        doc.text("Kaufvertrag", 105, y, { align: "center" });
        y += 15;

        doc.setFont("helvetica", "normal");
        doc.setFontSize(12);

        doc.text(`Zwischen ${verkaeufer} (nachfolgend "Verkäufer") und ${kaeufer} (nachfolgend "Käufer")`, 20, y);
        y += 8;
        doc.text(`wird folgender Kaufvertrag über einen gebrauchten PC geschlossen:`, 20, y);
        y += 12;

        let artikelText = `Der Verkäufer verkauft dem Käufer einen gebrauchten PC`;

        if (beschreibung !== "") {
          artikelText += ` mit folgender Beschreibung: ${beschreibung}.`;
        } else {
          artikelText += `.`;
        }

        const preisText = `Der vereinbarte Kaufpreis beträgt ${preis} Euro.`;

        doc.text(doc.splitTextToSize(artikelText, 170), 20, y);
        y += artikelText.length > 90 ? 16 : 10;

        doc.text(preisText, 20, y);
        y += 15;

        const haftung = `Der Verkauf erfolgt unter Ausschluss jeglicher Gewährleistung. Der Verkäufer übernimmt keine Garantie für Funktion, Zustand oder etwaige Mängel des Geräts. Der Käufer hat die Möglichkeit gehabt, das Gerät vor dem Kauf zu prüfen und akzeptiert den Artikel im aktuellen Zustand.`;

        doc.text(doc.splitTextToSize(haftung, 170), 20, y);
        y += 30;

        doc.text(`Ort: ${ort}`, 20, y);
        doc.text(`Datum: ${datum}`, 120, y);
        y += 20;

        doc.text("__________________________", 20, y);
        doc.text("Unterschrift Verkäufer", 20, y + 10);

        doc.text("__________________________", 120, y);
        doc.text("Unterschrift Käufer", 120, y + 10);

        doc.save("Kaufvertrag_PC.pdf");
      };
    }
  </script>
</body>
</html>
