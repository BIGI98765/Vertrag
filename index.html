<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Kaufvertrag Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
    }
    input, textarea, button {
      width: 100%;
      margin: 10px 0;
      padding: 8px;
      font-size: 16px;
    }
    label {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Kaufvertrag erstellen</h1>

  <label>Verkäufer (Name + Anschrift):</label>
  <textarea id="verkaeufer"></textarea>

  <label>Käufer (Name + Anschrift):</label>
  <textarea id="kaeufer"></textarea>

  <label>Artikelname:</label>
  <input id="artikel" />

  <label>Preis in €:</label>
  <input id="preis" type="number" />

  <label>Beschreibung (optional):</label>
  <textarea id="beschreibung"></textarea>

  <label>Ort:</label>
  <input id="ort" />

  <label>Datum:</label>
  <input id="datum" type="date" />

  <button onclick="generatePDF()">PDF erstellen</button>

  <script>
    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const icon = new Image();
      icon.src = 'icon.png'; // Stelle sicher, dass icon.png im gleichen Ordner liegt
      await new Promise(resolve => {
        icon.onload = resolve;
        icon.onerror = resolve;
      });

      if (icon.complete) {
        doc.addImage(icon, 'PNG', 80, 10, 50, 50);
      }

      doc.setFont("helvetica", "normal");
      doc.setFontSize(12);

      let y = 70;

      const verk = document.getElementById('verkaeufer').value;
      const kaeufer = document.getElementById('kaeufer').value;
      const artikel = document.getElementById('artikel').value;
      const preis = document.getElementById('preis').value;
      const beschreibung = document.getElementById('beschreibung').value.trim();
      const ort = document.getElementById('ort').value;
      const datum = document.getElementById('datum').value;
      const datumParts = datum.split('-');
      const datumFormatted = datumParts.length === 3 ? `${datumParts[2]}.${datumParts[1]}.${datumParts[0]}` : '';

      const text = [
        `Kaufvertrag zwischen folgendem Verkäufer und Käufer:`,
        ``,
        `Verkäufer: ${verk}`,
        `Käufer: ${kaeufer}`,
        ``,
        `Es wurde folgender Artikel verkauft:`,
        `${artikel}`,
        beschreibung ? `Beschreibung: ${beschreibung}` : ``,
        ``,
        `Der Artikel wurde zum Preis von ${preis} € verkauft und vom Käufer`,
        `zum oben genannten Preis vollständig bezahlt.`,
        ``,
        `Der Verkauf erfolgt unter Ausschluss jeglicher Garantie, Gewährleistung oder Rücknahme.`,
        `Der Käufer bestätigt, dass er den Artikel besichtigt und in seinem aktuellen Zustand akzeptiert hat.`,
        ``,
        `${ort}, den ${datumFormatted}`,
        ``,
        `_______________________      _______________________`,
        `Unterschrift Verkäufer          Unterschrift Käufer`
      ];

      text.forEach(line => {
        if (line.trim() !== "") {
          const lines = doc.splitTextToSize(line, 180);
          lines.forEach(l => {
            doc.text(l, 15, y);
            y += 8;
          });
        } else {
          y += 6;
        }
      });

      doc.save("kaufvertrag.pdf");
    }
  </script>
</body>
</html>
