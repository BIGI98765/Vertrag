<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kaufvertrag</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      padding: 20px;
    }
    label, input, button {
      display: block;
      margin-top: 10px;
    }
    .container {
      max-width: 500px;
      margin: auto;
    }
    button {
      margin-top: 20px;
      padding: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Kaufvertrag erstellen</h2>

    <label>Käufer (Name): <input id="kaeufer" type="text" /></label>
    <label>Verkäufer (Name): <input id="verkaeufer" type="text" /></label>
    <label>Produkt: <input id="produkt" type="text" /></label>
    <label>Preis (€): <input id="preis" type="number" /></label>
    <label>Ort: <input id="ort" type="text" value="Oldenburg" /></label>
    <label>Datum: <input id="datum" type="date" /></label>

    <button onclick="erzeugePDF()">PDF erstellen</button>
  </div>

  <script>
    async function erzeugePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      const kaeufer = document.getElementById('kaeufer').value;
      const verkaeufer = document.getElementById('verkaeufer').value;
      const produkt = document.getElementById('produkt').value;
      const preis = document.getElementById('preis').value;
      const ort = document.getElementById('ort').value;
      const datumRaw = document.getElementById('datum').value;

      const datum = datumRaw.split("-").reverse().join(".");

      // Logo laden (icon.png muss im gleichen Ordner liegen)
      const img = new Image();
      img.src = "icon.png";
      img.onload = () => {
        const canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;
        const ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);
        const dataURL = canvas.toDataURL("image/png");

        doc.addImage(dataURL, "PNG", 80, 10, 50, 50); // Logo mittig oben

        doc.setFontSize(12);
        doc.text(`Kaufvertrag`, 105, 70, { align: "center" });

        doc.setFontSize(10);
        doc.text(`Zwischen ${verkaeufer} (Verkäufer)`, 20, 90);
        doc.text(`und ${kaeufer} (Käufer)`, 20, 100);
        doc.text(`wird folgendes vereinbart:`, 20, 110);
        doc.text(`- Der Käufer erwirbt: ${produkt}`, 20, 120);
        doc.text(`- Kaufpreis: ${preis} Euro`, 20, 130);
        doc.text(`- Der Kauf erfolgt wie gesehen, ohne Garantie oder Rücknahme.`, 20, 140);
        doc.text(`${ort}, den ${datum}`, 20, 160);

        doc.text("_____________________", 20, 180);
        doc.text("Unterschrift Verkäufer", 20, 185);
        doc.text("_____________________", 120, 180);
        doc.text("Unterschrift Käufer", 120, 185);

        doc.save("Kaufvertrag.pdf");
      };
    }
  </script>
</body>
</html>
